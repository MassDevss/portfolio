
import { Component, Input,  OnInit, ElementRef, AfterViewInit, OnDestroy, ViewChild } from '@angular/core';


@Component({
  selector: 'app-tech-card',
  templateUrl: './tech-card.component.html',
  styleUrls: ['./tech-card.component.sass']
})
export class TechCardComponent implements OnInit, AfterViewInit, OnDestroy{

  @ViewChild('cardBody')
  cardElem: ElementRef<HTMLDivElement> | undefined;

  @Input()
  delay: number = 0;

  @Input()
  techName: string = '';

  @Input()
  techColor: string = '';

  toUseColor: string = '#fff';

  toBodyColor: string = '#131313';

  interval: any = null;

  swapColors(): void {
    this.toBodyColor = this.techColor;
    this.toUseColor = this.techColor;
  }

  outColors(): void {
    this.toBodyColor = '#131313';
    this.toUseColor = '#fff';
  }

  ngOnInit(): void {

    setTimeout(() => {
      this.swapColors()
    }, this.delay * 1000);

    setTimeout(() => {
      this.outColors()
    }, this.delay * 1000 + 500);

  }

  ngAfterViewInit(): void {
    this.interval = setInterval(() => {

      const random: number = Math.floor(Math.random() * 13);
      const card: HTMLDivElement | undefined = this.cardElem?.nativeElement;

      if (card && random === 11){
        setTimeout(() => {
          this.swapColors();
          card.classList.add('simulateHover');
        }, 500)

        setTimeout(() => {
          this.outColors();
          card.classList.remove('simulateHover');
        },1500)
      }

    }, 3500)
  }

  ngOnDestroy(): void {
    clearInterval(this.interval);
    this.interval = null;
  }

}
